{"version":3,"file":"errors.js","sourceRoot":"./src/","sources":["src/commands/errors.ts"],"names":[],"mappings":"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","sourcesContent":["import {RichEmbed} from \"discord.js\";\nimport { COLORS, BOT_ICON, ERROR_PREFIX, ERROR_RENDER_FORMAT, ErrorFormat } from \"../Constants\";\nimport { CommandUtils } from \"./util\";\n\nexport interface CommandErrorOptions {\n    message: string;\n    title?: string;\n    code?: string;\n    tracking?: string;\n    errorPrefix?: boolean;\n    render?: ErrorFormat;\n}\n\n/**\n * An error class that can be thrown by commands and guards which are rendered to the client\n */\nexport class CommandError {\n    public constructor(private options: CommandErrorOptions) {\n        options.title = options.title || \"Something went wrong\";\n        if (options.errorPrefix !== false) {\n            options.message = `${ERROR_PREFIX} ${options.message}`;\n        }\n    }\n\n    /**\n     * An embed render of the error\n     */\n    public get embed(): RichEmbed {\n        const embed = new RichEmbed();\n        embed.setTitle(this.options.title);\n        embed.setDescription(this.options.message);\n        embed.setColor(COLORS.DANGER);\n        CommandUtils.specializeEmbed(embed);\n        if (this.options.code || this.options.tracking) {\n            embed.setAuthor(`${this.options.code ? `${this.options.code} | ` : ''}${this.options.tracking ? `Error ID: ${this.options.tracking}` : ''}`);\n        }\n        return embed;\n    }\n\n    /**\n     * A plaintext render of the error\n     */\n    public get text(): string {\n        let message = `**${this.options.title}**\\n${this.options.message}`;\n        if (this.options.code || this.options.tracking) {\n            message += `\\n*`;\n            if (this.options.code) message += `${this.options.code}`;\n            if (this.options.code && this.options.tracking) message += \" | \";\n            if (this.options.tracking) message += `Error ID: ${this.options.tracking}`;\n        }\n        return message;\n    }\n\n    /**\n     * Determines which render to return based on the options or constant\n     */\n    public get render(): string | RichEmbed {\n        return (this.options.render || ERROR_RENDER_FORMAT) === ErrorFormat.EMBED ? this.embed : this.text;\n    }\n\n    public static get FORBIDDEN(): CommandError {\n        return new CommandError({\n            message: `You do not have the necessary permissions to do that.`,\n            title: \"Missing access\"\n        });\n    }\n\n    public static GENERIC({tracking, code}: {tracking?: string, code?: string}): CommandError {\n        return new CommandError({\n            message: `An error occurred while processing your request. Please try again later.`,\n            tracking,\n            code\n        });\n    }\n\n    public static BOT_MISSING_PERMISSIONS({tracking, permissions}: {tracking?: string, permissions?: string[]}): CommandError {\n        return new CommandError({\n            message: `I can't do that right now because I'm missing ${permissions ? `the following permissions: \\n - ${permissions.join('\\n - ')}` : 'the necessary permissions'}`,\n            title: \"Missing permissions\",\n            tracking\n        });\n    }\n}"]}