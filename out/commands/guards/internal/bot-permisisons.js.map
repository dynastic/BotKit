{"version":3,"file":"bot-permisisons.js","sourceRoot":"./src/","sources":["commands/guards/internal/bot-permisisons.ts"],"names":[],"mappings":";;AACA,yCAA4C;AAK/B,QAAA,cAAc,GAA0D,CAAC,GAAG,KAA8B,EAAE,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,EAAE;IAChJ,MAAM,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC;IAE9B,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,KAAK,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;IACvH,MAAM,IAAI,GAAG,OAAO,CAAC,MAAM,KAAK,CAAC,CAAC;IAElC,IAAI,IAAI,EAAE;QACN,OAAO,IAAI,EAAE,CAAC;KACjB;IAED,MAAM,OAAO,CAAC,IAAI,EAAE,CAAC;IACrB,OAAO,IAAI,CAAC,IAAI,qBAAY,CAAC;QACzB,OAAO,EAAE,gGAAgG,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,KAAK,IAAI,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;QACxJ,KAAK,EAAE,qBAAqB;KAC/B,CAAC,CAAC,CAAC;AACR,CAAC,CAAA","sourcesContent":["import { PermissionString } from \"discord.js\";\nimport { CommandError } from \"../../errors\";\nimport { CommandHandler } from \"../../util\";\n\nexport type ExtraPermissionString = PermissionString | \"OWNER\";\n\nexport const BotPermissions: (...perms: ExtraPermissionString[]) => CommandHandler = (...perms: ExtraPermissionString[]) => async (message, next) => {\n    const self = message.guild.me;\n\n    const missing = perms.filter(perm => perm === \"OWNER\" ? self.id === message.guild.ownerID : !self.hasPermission(perm));\n    const pass = missing.length === 0;\n\n    if (pass) {\n        return next();\n    }\n\n    await message.fail();\n    return next(new CommandError({\n        message: `I don't have permission to do that. Please give me the following permissions and try again:\\n${missing.map(perm => `\\`${perm}\\``).join(\"\\n\")}`,\n        title: \"Missing Permissions\"\n    }));\n}"]}