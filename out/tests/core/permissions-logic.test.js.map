{"version":3,"file":"permissions-logic.test.js","sourceRoot":"./src/","sources":["tests/core/permissions-logic.test.ts"],"names":[],"mappings":";;AAAA,iBAAe;AAEf,+BAA4C;AAC5C,8DAA2F;AAE3F,MAAM,EAAC,YAAY,EAAC,GAAG,qBAAc,CAAC;AACtC,MAAM,EAAC,WAAW,EAAC,GAAG,qBAAc,CAAC,KAAK,CAAC;AAE3C,QAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE;IAC9B,EAAE,CAAC,sCAAsC,EAAE,GAAG,EAAE;QAC5C,MAAM,UAAU,GAAG,2BAAoB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QACxD,MAAM,YAAY,GAAG,WAAW,CAAC,UAAU,CAAC,CAAC;QAC7C,MAAM,SAAS,GAAG,YAAY,CAAC,KAAK,CAAC,CAAC,EAAE,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC;QAE1F,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,aAAM,CAAC,YAAY,CAAC,UAAU,EAAE,QAAQ,CAAC,EAAE,GAAG,QAAQ,wBAAwB,UAAU,eAAe,CAAC,CAAC,CAAC;IAC5I,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;QACvD,MAAM,UAAU,GAAG,2BAAoB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QACxD,MAAM,YAAY,GAAG,UAAU,GAAG,IAAI,CAAC;QAEvC,aAAM,CAAC,CAAC,YAAY,CAAC,UAAU,EAAE,YAAY,CAAC,EAAE,GAAG,YAAY,8BAA8B,UAAU,eAAe,CAAC,CAAC;IAC5H,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,6BAA6B,EAAE,GAAG,EAAE;QACnC,MAAM,KAAK,GAAG,2BAAoB,CAAC,iBAAiB,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;QAE5D,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,aAAM,CAAC,CAAC,YAAY,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,GAAG,KAAK,8BAA8B,KAAK,eAAe,CAAC,CAAC,CAAC;IACvI,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,2BAA2B,EAAE,GAAG,EAAE;QACjC,MAAM,KAAK,GAAG,2BAAoB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAEnD,aAAM,CAAC,YAAY,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,GAAG,KAAK,kCAAkC,KAAK,mBAAmB,CAAC,CAAA;IAC1G,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,iFAAiF,EAAE,GAAG,EAAE;QACvF,MAAM,KAAK,GAAG,2BAAoB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QACnD,MAAM,KAAK,GAAG,KAAK,GAAG,GAAG,GAAG,2BAAoB,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAEjE,aAAM,CAAC,CAAC,YAAY,CAAC,KAAK,EAAE,KAAK,CAAC,EAAE,GAAG,KAAK,8BAA8B,KAAK,eAAe,CAAC,CAAC;IACpG,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","sourcesContent":["import 'mocha';\n\nimport chai, { expect, assert } from 'chai';\nimport { PermissionsAPI, _PermissionInternals } from '../../src/commands/permissions/util';\n\nconst {nodesSatisfy} = PermissionsAPI;\nconst {segmentNode} = PermissionsAPI.Utils;\n\ndescribe(\"satisfying nodes\", () => {\n    it(\"should accept wildcards at any level\", () => {\n        const sampleNode = _PermissionInternals.generateNode(3);\n        const nodeSegments = segmentNode(sampleNode);\n        const wildcards = nodeSegments.slice(0, nodeSegments.length - 1).map(node => node + \".*\");\n        \n        wildcards.forEach(wildcard => assert(nodesSatisfy(sampleNode, wildcard), `${wildcard} should've satisfied ${sampleNode}, but doesn't`));\n    });\n\n    it(\"should reject wildcards that are below the node\", () => {\n        const sampleNode = _PermissionInternals.generateNode(3);\n        const wildcardNode = sampleNode + \".*\";\n\n        assert(!nodesSatisfy(sampleNode, wildcardNode), `${wildcardNode} should not have satisfied ${sampleNode}, but it does`);\n    });\n\n    it(\"should reject inequal nodes\", () => {\n        const nodes = _PermissionInternals.generateNodePairs(50, 3);\n\n        nodes.forEach(([node1, node2]) => assert(!nodesSatisfy(node1, node2), `${node1} should not have satisfied ${node2}, but it does`));\n    });\n\n    it(\"should accept equal nodes\", () => {\n        const node1 = _PermissionInternals.generateNode(3);\n\n        assert(nodesSatisfy(node1, node1), `${node1} should have satisfied itself (${node1}), but it doesn't`)\n    });\n\n    it(\"should not accept higher-level nodes without a wildcard (a.b NOT SATISFY a.b.c)\", () => {\n        const node1 = _PermissionInternals.generateNode(3);\n        const node2 = node1 + \".\" + _PermissionInternals.generateNode(3);\n\n        assert(!nodesSatisfy(node1, node2), `${node1} should not have satisfied ${node2}, but it does`);\n    });\n});"]}